# ar_weights.py
# Andreas Brink-Kjaer
# Spring 2018
#
''' 
ar_weights computes weights for training labels.
'''

import numpy as np

def train_ar_weights(y,approach=1):
	'''This function computes weights for arousal labels based on consensus of sleep technicians.

	Args: 
		y: input annotations.
		approach: option for weights (1 == ones, 2 == zeros at plus-minus 2 seconds at transitions, 3 == Weighted by sleep technician consensus).
	'''

	if approach == 1:
		return np.ones(shape=y.shape)

	else:
		w = np.ones(shape=y.shape)
		if approach == 3:
			w_fun = agreement_weight_fun()
		i = -1
		ar_present = 0
		set_weights = 0

		while i < y.shape[0]-1:
			i += 1
			if y[i] == 1 and not ar_present == 1:
				ar_start = i
				ar_present = 1

			if y[i] == 0 and ar_present == 1:
				ar_stop = i
				ar_present = 0
				set_weights = 1

			if set_weights == 1:
				if approach == 2:
					if ar_start - 2 < 0:
						continue
					elif ar_start + 2 > len(w) - 1:
						continue
					if ar_stop - 2 < 0:
						continue
					elif ar_stop + 2 > len(w) - 1:
						continue
					w[ar_start-2:ar_start+2] = np.zeros(shape=(5,1))
					w[ar_stop-2:ar_stop+2] = np.zeros(shape=(5,1))
				elif approach == 3:
					if ar_start - 10 < 0:
						continue
					elif ar_stop + 10 > len(w) - 1:
						continue
					dur = ar_stop - ar_start
					w[ar_start-10:ar_stop+10] = w_fun[dur-1,:dur+20]
				
				set_weights = 0
		return w


def agreement_weight_fun():
	'''Get sleep technician consensus for arousals with a given duration. Number are hard-coded to avoid excessive computation of consensus fitting function'''
	w_fun = np.array([[1.000,1.000,1.000,1.000,1.000,0.998,0.994,0.980,0.934,0.818,0.344,0.636,0.779,0.905,0.965,0.988,0.996,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,1.000,0.997,0.983,0.930,0.783,0.471,0.635,0.442,0.641,0.811,0.911,0.961,0.983,0.993,0.997,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,1.000,0.997,0.981,0.922,0.755,0.542,0.784,0.791,0.379,0.593,0.767,0.877,0.939,0.970,0.986,0.993,0.997,0.998,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,1.000,0.996,0.978,0.914,0.736,0.586,0.872,0.941,0.829,0.371,0.578,0.744,0.855,0.922,0.959,0.978,0.989,0.994,0.997,0.998,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,1.000,0.995,0.976,0.908,0.723,0.613,0.926,1.000,0.977,0.818,0.383,0.578,0.733,0.842,0.910,0.950,0.972,0.985,0.992,0.996,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,1.000,0.995,0.974,0.904,0.714,0.632,0.961,1.000,1.000,0.962,0.790,0.403,0.585,0.730,0.834,0.901,0.943,0.967,0.981,0.989,0.994,0.997,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.999,0.994,0.972,0.901,0.707,0.645,0.985,1.000,1.000,1.000,0.930,0.757,0.427,0.596,0.732,0.831,0.896,0.938,0.963,0.978,0.987,0.993,0.996,0.997,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.999,0.993,0.971,0.898,0.702,0.654,1.000,1.000,1.000,1.000,1.000,0.891,0.721,0.454,0.612,0.738,0.831,0.894,0.935,0.960,0.976,0.986,0.991,0.995,0.997,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.999,0.993,0.970,0.896,0.699,0.660,1.000,1.000,1.000,1.000,1.000,0.998,0.850,0.684,0.482,0.630,0.748,0.834,0.894,0.933,0.958,0.974,0.984,0.990,0.994,0.996,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.999,0.992,0.969,0.894,0.696,0.665,1.000,1.000,1.000,1.000,1.000,1.000,0.956,0.807,0.645,0.512,0.650,0.759,0.839,0.896,0.933,0.958,0.973,0.983,0.990,0.994,0.996,0.997,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.992,0.968,0.893,0.694,0.669,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.912,0.763,0.606,0.543,0.671,0.772,0.846,0.899,0.934,0.958,0.973,0.983,0.989,0.993,0.996,0.997,0.998,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.991,0.968,0.892,0.692,0.672,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.997,0.865,0.717,0.565,0.575,0.693,0.786,0.855,0.903,0.936,0.958,0.973,0.983,0.989,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.991,0.967,0.891,0.691,0.674,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.951,0.816,0.670,0.525,0.607,0.716,0.801,0.864,0.908,0.939,0.960,0.974,0.983,0.989,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.991,0.967,0.891,0.690,0.675,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.902,0.765,0.622,0.484,0.639,0.739,0.816,0.874,0.914,0.942,0.962,0.975,0.983,0.989,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.991,0.966,0.890,0.689,0.677,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.974,0.850,0.712,0.573,0.443,0.670,0.762,0.832,0.884,0.920,0.946,0.964,0.976,0.984,0.989,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.991,0.966,0.890,0.688,0.678,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.923,0.795,0.659,0.525,0.403,0.701,0.784,0.847,0.894,0.927,0.950,0.966,0.977,0.985,0.990,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.890,0.688,0.679,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.985,0.868,0.738,0.604,0.477,0.363,0.731,0.806,0.862,0.904,0.933,0.954,0.969,0.979,0.985,0.990,0.993,0.995,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.889,0.687,0.680,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.931,0.809,0.680,0.550,0.430,0.326,0.760,0.826,0.877,0.913,0.940,0.958,0.971,0.980,0.986,0.991,0.994,0.996,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.889,0.687,0.680,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.985,0.873,0.749,0.620,0.497,0.385,0.290,0.787,0.846,0.890,0.923,0.946,0.962,0.974,0.982,0.988,0.991,0.994,0.996,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.889,0.687,0.681,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.928,0.811,0.686,0.561,0.445,0.342,0.256,0.812,0.864,0.903,0.931,0.952,0.966,0.976,0.984,0.989,0.992,0.995,0.996,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.889,0.686,0.681,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.975,0.866,0.746,0.623,0.503,0.394,0.301,0.225,0.835,0.881,0.915,0.939,0.957,0.970,0.979,0.985,0.990,0.993,0.995,0.996,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.889,0.686,0.681,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.915,0.801,0.680,0.560,0.447,0.347,0.263,0.196,0.857,0.896,0.926,0.947,0.962,0.973,0.981,0.987,0.991,0.993,0.995,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.957,0.849,0.733,0.613,0.498,0.393,0.303,0.228,0.169,0.876,0.910,0.935,0.954,0.967,0.977,0.983,0.988,0.992,0.994,0.996,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.993,0.892,0.780,0.663,0.547,0.438,0.343,0.262,0.197,0.145,0.894,0.923,0.944,0.960,0.971,0.980,0.985,0.990,0.993,0.995,0.996,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.929,0.822,0.708,0.592,0.482,0.382,0.296,0.225,0.168,0.124,0.909,0.934,0.952,0.966,0.975,0.982,0.987,0.991,0.994,0.995,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.962,0.860,0.749,0.635,0.523,0.420,0.330,0.253,0.191,0.143,0.105,0.923,0.944,0.959,0.971,0.979,0.985,0.989,0.992,0.994,0.996,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.990,0.893,0.786,0.673,0.562,0.457,0.362,0.282,0.215,0.162,0.120,0.089,0.935,0.953,0.966,0.975,0.982,0.987,0.991,0.993,0.995,0.996,0.997,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.921,0.818,0.708,0.598,0.491,0.394,0.309,0.238,0.181,0.136,0.101,0.074,0.945,0.960,0.971,0.979,0.985,0.989,0.992,0.994,0.996,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.683,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.946,0.847,0.740,0.630,0.523,0.424,0.336,0.261,0.200,0.151,0.113,0.084,0.062,0.954,0.967,0.976,0.982,0.987,0.991,0.993,0.995,0.996,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.683,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.967,0.872,0.767,0.659,0.552,0.452,0.361,0.283,0.219,0.167,0.126,0.094,0.070,0.051,0.962,0.972,0.980,0.985,0.989,0.992,0.994,0.996,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.683,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.985,0.893,0.791,0.685,0.578,0.477,0.385,0.304,0.237,0.182,0.138,0.103,0.077,0.057,0.042,0.969,0.977,0.983,0.988,0.991,0.993,0.995,0.996,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.683,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.911,0.812,0.707,0.602,0.500,0.406,0.324,0.254,0.196,0.149,0.113,0.085,0.063,0.047,0.035,0.974,0.981,0.986,0.990,0.992,0.994,0.996,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.685,0.683,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.926,0.830,0.727,0.622,0.520,0.426,0.342,0.269,0.209,0.161,0.122,0.092,0.069,0.052,0.038,0.028,0.979,0.984,0.988,0.991,0.994,0.995,0.997,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.938,0.844,0.743,0.640,0.538,0.443,0.358,0.284,0.222,0.171,0.131,0.099,0.075,0.056,0.042,0.031,0.023,0.983,0.987,0.991,0.993,0.995,0.996,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.997,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.948,0.856,0.756,0.654,0.553,0.458,0.372,0.296,0.233,0.180,0.139,0.105,0.080,0.060,0.045,0.034,0.025,0.019,0.986,0.990,0.992,0.994,0.996,0.997,0.998,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.955,0.865,0.767,0.666,0.566,0.470,0.384,0.307,0.242,0.189,0.146,0.111,0.085,0.064,0.048,0.036,0.027,0.020,0.015,0.989,0.992,0.994,0.995,0.997,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.965,0.888,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.960,0.871,0.775,0.675,0.575,0.480,0.393,0.316,0.251,0.196,0.152,0.117,0.089,0.067,0.051,0.038,0.029,0.022,0.016,0.012,0.991,0.993,0.995,0.996,0.997,0.998,0.998,0.999,0.999,0.999,1.000,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.965,0.889,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.963,0.875,0.780,0.681,0.582,0.488,0.401,0.324,0.258,0.202,0.157,0.121,0.093,0.071,0.053,0.040,0.030,0.023,0.017,0.013,0.010,0.993,0.995,0.996,0.997,0.998,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.889,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.964,0.877,0.783,0.685,0.587,0.493,0.406,0.329,0.263,0.207,0.161,0.125,0.096,0.073,0.056,0.042,0.032,0.024,0.018,0.014,0.010,0.008,0.994,0.996,0.997,0.998,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000],
     [1.000,1.000,1.000,1.000,1.000,0.998,0.990,0.966,0.889,0.686,0.682,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.963,0.876,0.783,0.686,0.589,0.496,0.410,0.333,0.266,0.211,0.165,0.128,0.098,0.075,0.057,0.044,0.033,0.025,0.019,0.014,0.011,0.008,0.006,0.995,0.997,0.997,0.998,0.999,0.999,0.999,0.999,1.000,1.000,1.000]]);
	return w_fun
